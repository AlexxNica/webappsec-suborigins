<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Suborigins</title>
<style data-fill-with="stylesheet">/* This section copied from the W3C's ED styles. */

	body {
		color: black;
		font-family: sans-serif;
		margin: 0 auto;
		max-width: 50em;
		padding: 2em 1em 2em 70px;
	}
	:link { color: #00C; background: transparent }
	:visited { color: #609; background: transparent }
	a[href]:active { color: #C00; background: transparent }
	a[href]:hover { background: #ffa }

	a[href] img { border-style: none }

	h1, h2, h3, h4, h5, h6 { text-align: left }
	h1, h2, h3 { color: #005A9C; }
	h1 { font: 170% sans-serif }
	h2 { font: 140% sans-serif }
	h3 { font: 120% sans-serif }
	h4 { font: bold 100% sans-serif }
	h5 { font: italic 100% sans-serif }
	h6 { font: small-caps 100% sans-serif }

	.hide { display: none }

	div.head { margin-bottom: 1em }
	div.head h1 { margin-top: 2em; clear: both }
	div.head table { margin-left: 2em; margin-top: 2em }

	p.copyright { font-size: small }
	p.copyright small { font-size: small }

	pre { margin-left: 2em }
	dt { font-weight: bold }

	ul.toc, ol.toc {
		list-style: none;
	}

/* The rest copied from the CSSWG's default.css */

	body {
		counter-reset: exampleno figure issue;
		max-width: 50em;
		margin: 0 auto !important;
		line-height: 1.5;
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
	}

	h2, h3, h5, h6 {
		margin-top: 3em;
	}
	h4 {
		 margin-top: 4em;
	}

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle + h2 {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/
	/* <hr> used to separate TMI into the second half of a section              */
	hr:not([title]) {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	hr:not([title])::before {
		content: "\1F411\2003\2003\1F411\2003\2003\1F411";
	}
	/* note: <hr> with title separates document header from contents */

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}
	dd     > p:first-child,
	li     > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}
	li {
		margin: 0.25em 2em 0.5em 0;
		padding-left: 0;
	}

	dl dd {
		margin: 0 0 1em 2em;
	}
	.head dd {
		margin-bottom: 0;
	}

	/* Style for algorithms */
	ol.algorithm ol {
	 border-left: 1px solid #90b8de;
	 margin-left: 1em;
	}
	ol.algorithm ol.algorithm {
	 border-left: none;
	 margin-left: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

	/* Style for paragraphs I know are in MD-genned lists */
	[data-md] > :first-child {
		margin-top: 0;
	}
	[data-md] > :last-child {
		margin-bottom: 0;
	}

/** Inline Lists **************************************************************/
	/* This is mostly to make the list inside the CR exit criteria more compact. */

	ol.inline, ol.inline li {
		display: inline;
		padding: 0; margin: 0;
	}
	ol.inline {
		counter-reset: list-item;
	}
	ol.inline li {
		counter-increment: list-item;
	}
	ol.inline li::before {
		content: "(" counter(list-item) ") ";
		font-weight: bold;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
		font-size: .9em;
		page-break-inside: avoid;
	}
	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Syntax-Highlighted Code ***************************************************/

	.example pre[class*="language-"],
	.example [class*="language-"] pre,
	.example pre[class*="lang-"],
	.example [class*="lang-"] pre {
		background: transparent; /* Prism applies a gray background that doesn't work well in the template. */
	}

/** Example Code **************************************************************/

	div.html, div.xml,
	pre.html, pre.xml {
		padding: 0.5em;
		margin: 1em 0;
		position: relative;
		clear: both;
		color: #600;
	}
	pre.example,
	pre.html,
	pre.xml {
		padding-top: 1.5em;
	}

	pre.illegal, .illegal pre
	pre.deprecated, .deprecated pre {
		color: red;
	}

/** IDL fragments *************************************************************/

	pre.idl {
		/* Match blue propdef boxes */
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}
	pre.idl :link, pre.idl :visited {
		color:inherit;
		background:transparent;
	}

/** Inline CSS fragments ******************************************************/

	.css.css, .property.property, .descriptor.descriptor {
		color: #005a9c;
		font-size: inherit;
		font-family: inherit;
	}
	.css::before, .property::before, .descriptor::before {
		content: "‘";
	}
	.css::after, .property::after, .descriptor::after {
		content: "’";
	}
	.property, .descriptor {
		/* Don't wrap property and descriptor names */
		white-space: nowrap;
	}
	.type { /* CSS value <type> */
	font-style: italic;
	}
	pre .property::before, pre .property::after {
		content: "";
	}

/** Inline markup fragments ***************************************************/

	code.html, code.xml {
		color: #660000;
	}

/** Autolinks produced using Bikeshed *****************************************/

	[data-link-type="property"]::before,
	[data-link-type="propdesc"]::before,
	[data-link-type="descriptor"]::before,
	[data-link-type="value"]::before,
	[data-link-type="function"]::before,
	[data-link-type="at-rule"]::before,
	[data-link-type="selector"]::before,
	[data-link-type="maybe"]::before {
		content: "‘";
	}
	[data-link-type="property"]::after,
	[data-link-type="propdesc"]::after,
	[data-link-type="descriptor"]::after,
	[data-link-type="value"]::after,
	[data-link-type="function"]::after,
	[data-link-type="at-rule"]::after,
	[data-link-type="selector"]::after,
	[data-link-type="maybe"]::after {
		content: "’";
	}

	[data-link-type].production::before,
	[data-link-type].production::after,
	.prod [data-link-type]::before,
	.prod [data-link-type]::after {
		content: "";
	}

	[data-link-type=element]         { font-family: monospace; }
	[data-link-type=element]::before { content: "<" }
	[data-link-type=element]::after  { content: ">" }

	[data-link-type=biblio] {
		white-space: pre;
	}


/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a:link, a:visited {
		color: inherit;
		text-decoration: none;
		border-bottom: 1px solid silver;
	}
	@supports (text-decoration-color: silver) {
		a:link, a:visited {
			border-bottom: none;
			text-decoration: underline;
			text-decoration-color: silver;
		}
		a:visited {
			text-decoration-style: dotted;
		}
	}

	a.logo:link, a.logo:visited { /* backout above styling for W3C logo */
		padding: 0;
		border: none;
		text-decoration: none;
	}

/** Self-Links ****************************************************************/
	/* Auto-generated links from an element to its own anchor, for usability */

	.heading, .issue, .note, .example, li, dt {
		position: relative;
	}
	a.self-link {
		position: absolute;
		top: 0;
		left: -2.5em;
		width: 2em;
		height: 2em;
		text-align: center;
		border: none;
		transition: opacity .2s;
		opacity: .5;
	}
	a.self-link:hover {
		opacity: 1;
	}
	.heading > a.self-link {
		font-size: 83%;
	}
	li > a.self-link {
		left: -3.5em;
	}
	dfn > a.self-link {
		top: auto;
		left: auto;
		opacity: 0;
		width: 1.5em;
		height: 1.5em;
		background: gray;
		color: white;
		font-style: normal;
		transition: opacity .2s, background-color .2s, color .2s;
	}
	dfn:hover > a.self-link {
		opacity: 1;
	}
	dfn > a.self-link:hover {
		color: black;
	}

	a.self-link::before            { content: "¶"; }
	.heading > a.self-link::before { content: "§"; }
	dfn > a.self-link::before      { content: "#"; }

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	figure, div.figure, div.sidefigure {
		page-break-inside: avoid;
	}

	div.figure, p.figure, div.sidefigure, figure {
		text-align: center;
		margin: 2.5em 0;
	}
	div.figure pre, div.sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	div.sidefigure, figure.sidefigure {
		float: right;
		width: 50%;
		margin: 0 0 0.5em 0.5em
	}
	div.figure img, div.sidefigure img, figure img,
	div.figure object, div.sidefigure object, figure object {
		display: block;
		margin: auto;
		max-width: 100%
	}
	p.caption, figcaption, caption {
		text-align: center;
		font-style: italic;
		font-size: 90%;
	}
	p.caption:not(.no-marker)::before, figcaption:not(.no-marker)::before {
		content: "Figure " counter(figure) ". ";
	}
	p.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	p.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > div.figure, dd > figure { margin-left: -2em }

	pre.ascii-art {
		display: table; /* shrinkwrap */
		margin: 1em auto;
	}

	/* Displaying the output of text layout, particularly when
		 line-breaking is being invoked, and thus having a
		 visible width is good. */
	pre.output {
		margin: 1em;
		border: solid thin silver;
		padding: 0.25em;
		display: table;
	}

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .why, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	div.issue,
	div.note,
	div.example,
	details.why,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/
	/* not intended for CR+ publication */

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue:not(.no-marker)::before {
		content: "ISSUE " counter(issue);
		padding-right: 1em;
	}
	.issue::before, .issue > .marker {
		color: #AE1E1E;
	}

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: exampleno;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #827017;
		font-family: sans-serif;
		min-width: 7.5em;
		display: block;
	}
	.example:not(.no-marker)::before {
		content: "EXAMPLE";
		content: "EXAMPLE " counter(exampleno);
	}
	.invalid.example::before, .invalid.example > .marker,
	.illegal.example::before, .illegal.example > .marker {
		color: red;
	}
	.invalid.example:not(.no-marker)::before,
	.illegal.example:not(.no-marker)::before {
		content: "INVALID EXAMPLE";
		content: "INVALID EXAMPLE" counter(exampleno);
	}

/** Non-normative Note ********************************************************/

	.note, .why {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}
	.note::before, .note > .marker {
		display: block;
		color: hsl(120, 70%, 30%);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
		text-align: center;
	}
	strong.advisement {
		display: block;
	}
	/*.advisement::before { color: #FF8800; } */

/** ??? ***********************************************************************/

	details.why {
		border-color: #52E052;
		background: #E9FBE9;
		display: block;
	}

	details.why > summary {
		font-style: italic;
		display: block;
	}

	details.why[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details.annoying-warning {
		display: block;
	}

	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
		border: thick solid red;
		border-radius: 1em;
	}
@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

/** Property/Descriptor Definition Tables *************************************/

	table.propdef, table.propdef-extra,
	table.descdef, table.definition-table {
		page-break-inside: avoid;
		width: 100%;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
		padding: 0.5em 1em;
		background: #DEF;
		border-spacing: 0;
	}

	table.propdef td, table.propdef-extra td,
	table.descdef td, table.definition-table td,
	table.propdef th, table.propdef-extra th,
	table.descdef th, table.definition-table th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}
	table.propdef > tbody > tr:last-child th,
	table.propdef-extra > tbody > tr:last-child th,
	table.descdef > tbody > tr:last-child th,
	table.definition-table > tbody > tr:last-child th,
	table.propdef > tbody > tr:last-child td,
	table.propdef-extra > tbody > tr:last-child td,
	table.descdef > tbody > tr:last-child td,
	table.definition-table > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.propdef th,
	table.propdef-extra th,
	table.descdef th,
	table.definition-table th {
		font-style: italic;
		font-weight: normal;
		width: 8.3em;
		padding-left: 1em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a propdef */
	table.propdef td.footnote,
	table.propdef-extra td.footnote,
	table.descdef td.footnote,
	table.definition-table td.footnote {
		padding-top: 0.6em;
	}
	table.propdef td.footnote::before,
	table.propdef-extra td.footnote::before,
	table.descdef td.footnote::before,
	table.definition-table td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Profile Tables ************************************************************/
	/* table of required features in a CSS profile */

	table.features th {
		background: #00589f;
		color: #fff;
		text-align: left;
		padding: 0.2em 0.2em 0.2em 0.5em;
	}
	table.features td {
		vertical-align: top;
		border-bottom: 1px solid #ccc;
		padding: 0.3em 0.3em 0.3em 0.7em;
	}

/** Data tables (and properly marked-up proptables) ***************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
	*/

	.data, .proptable {
		margin: 1em auto;
		border-collapse: collapse;
		width: 100%;
		border: hidden;
	}
	.data {
		text-align: center;
		width: auto;
	}
	.data caption {
		width: 100%;
	}

	.data td, .data th,
	.proptable td, .proptable th {
		padding: 0.5em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	.data thead td:empty {
		padding: 0;
		border: 0;
	}

	.data thead th[scope="row"],
	.proptable thead th[scope="row"] {
		text-align: right;
		color: inherit;
	}

	.data thead,
	.proptable thead,
	.data tbody,
	.proptable tbody {
		color: inherit;
		border-bottom: 2px solid;
	}

	.data colgroup {
		border-left: 2px solid;
	}

	.data tbody th:first-child,
	.proptable tbody th:first-child ,
	.data tbody td[scope="row"]:first-child,
	.proptable tbody td[scope="row"]:first-child {
		text-align: right;
		color: inherit;
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}
	.data.define td:last-child {
		text-align: left;
	}

	.data tbody th[rowspan],
	.proptable tbody th[rowspan],
	.data tbody td[rowspan],
	.proptable tbody td[rowspan]{
		border-left:  1px solid silver;
		border-right: 1px solid silver;
	}

	.complex.data th,
	.complex.data td {
		border: 1px solid silver;
	}

	.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	.data img {
		vertical-align: middle;
	}


/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	/* ToC not indented, but font style shows hierarchy */
	ul.toc           { margin: 1em 0;     font-weight: bold; /*text-transform: uppercase;*/ }
	ul.toc ul        { margin: 0;        font-weight: normal; text-transform: none; }
	ul.toc ul ul     { margin: 0 0 0 2em; font-style: italic; }
	ul.toc ul ul ul  { margin: 0; }
	ul.toc > li      { margin: 1.5em 0; }
	ul.toc ul.toc li { margin: 0.3em 0 0 0; }

	ul.toc, ul.toc ul, ul.toc li { padding: 0; line-height: 1.3; }
	ul.toc a { text-decoration: none; border-bottom-style: none; }
	ul.toc a:hover, ul.toc a:focus  { border-bottom-style: solid; }
	@supports (text-decoration-style: solid) {
		ul.toc a:hover, ul.toc a:focus  {
			border-bottom-style: none;
			text-decoration-style: solid;
		}
	}
	/*
	ul.toc li li li, ul.toc li li li ul {margin-left: 0; display: inline}
	ul.toc li li li ul, ul.toc li li li ul li {margin-left: 0; display: inline}
	*/

	/* Section numbers in a column of their own */
	ul.toc {
		margin-left: 5em
	}
	ul.toc span.secno {
		float: left;
		width: 4em;
		margin-left: -5em;
	}
	ul.toc ul ul span.secno {
		margin-left: -7em;
	}
	/*ul.toc span.secno {text-align: right}*/
	ul.toc li {
		clear: both;
	}
	/* If we had 'tab', floats would not be needed here:
		 ul.toc span.secno {tab: 5em right; margin-right: 1em}
		 ul.toc li {text-indent: 5em hanging}
	 The second line in case items wrap
	*/

/** At-risk List **************************************************************/
	/* Style for At Risk features (intended as editorial aid, not intended for publishing) */

	.atrisk::before {
	 float: right;
	 margin-top: -0.25em;
	 padding: 0.5em 1em 0.5em 0;
	 text-indent: -0.9em;
	 border: 1px solid;
	 content: '\25C0    Not yet widely implemented';
	 white-space: pre;
	 font-size: small;
	 background-color: white;
	 color: gray;
	 text-align: center;
	}

	.toc .atrisk::before { content:none }

/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.indexlist       { margin-left: 0; columns: 15em; -webkit-columns: 15em; text-indent: 1em hanging; }
	ul.indexlist li    { margin-left: 0; list-style: none; break-inside: avoid; word-break: break-word; }
	ul.indexlist li li { margin-left: 1em }
	ul.indexlist dl    { margin-top: 0; }
	ul.indexlist dt    { margin: .2em 0 .2em 20px;}
	ul.indexlist dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.indexlist ul,
	ul.indexlist dl { font-size: smaller; }
	ul.indexlist li span {
		white-space: nowrap;
		position: absolute;
		color: transparent; }
	ul.indexlist li a:hover + span,
	ul.indexlist li a:focus + span {
		color: gray;
	}
	@media print {
		ul.indexlist li span { color: gray; }
	}

/** Property Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.proptable {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.proptable td,
	table.proptable th {
		padding: 0.4em;
		text-align: center;
	}

	table.proptable tr:hover td {
		background: #DEF;
	}
	.propdef th {
		font-style: italic;
		font-weight: normal;
		text-align: left;
		width: 3em;
	}
	/* The link in the first column in the property table (formerly a TD) */
	table.proptable td .property,
	table.proptable th .property {
		display: block;
		text-align: left;
		font-weight: bold;
	}

/** Extra-large Elements ******************************************************/

	.big-element-wrapper {
		max-width: 50em;
		overflow-x: auto;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		html {
			margin: 0 !important; }
		body {
			font-family: serif; }
		th, td {
			font-family: inherit; }
		a {
			color: inherit !important; }

		a:link, a:visited {
			text-decoration: none !important }
		a:link::after, a:visited::after { /* create a cross-ref "see..." */ }
		.example::before {
			font-family: serif !important; }
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

</style>
  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Suborigins</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2016-03-09">9 March 2016</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webappsec-suborigins/">https://w3c.github.io/webappsec-suborigins/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5Bsuborigins%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[suborigins] <i data-lt="">… message topic …</i></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/w3c/webappsec-suborigins/issues/">GitHub</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://joelweinberger.us">Joel Weinberger</a> (<span class="p-org org">Google Inc.</span>) <a class="u-email email" href="mailto:jww@google.com">jww@google.com</a>
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="http://devd.me">Devdatta Akhawe</a> (<span class="p-org org">Dropbox Inc.</span>) <a class="u-email email" href="mailto:dev.akhawe@gmail.com">dev.akhawe@gmail.com</a>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2016 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines a mechanism for programmatically defining origins

to isolate different applications running in the same physical origin. It
allows a server to specify a namespace on a resource response which is paired
with the scheme/host/port origin tuple. User agents extend the same-origin
policy with this new namespace plus origin tuple to create a security
boundary between this resource and resources in other namespaces.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> <strong>Changes to this document may be tracked at <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong> </p>
   <p> The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5Bsuborigins%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “suborigins” in the subject,
	preferably like this:
	“[suborigins] <em>…summary of comment…</em>” </p>
   <p> This document was produced by the <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a>
      <li><a href="#usecases"><span class="secno">1.2</span> <span class="content">Use Cases/Examples</span></a>
     </ul>
    <li>
     <a href="#terms"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
     <ul class="toc">
      <li><a href="#grammar"><span class="secno">2.1</span> <span class="content">Grammatical Concepts</span></a>
     </ul>
    <li>
     <a href="#defining-suborigin"><span class="secno">3</span> <span class="content">Defining a Suborigin</span></a>
     <ul class="toc">
      <li>
       <a href="#difficulties"><span class="secno">3.1</span> <span class="content">Difficulties using subdomains</span></a>
       <ul class="toc">
        <li><a href="#separate-applications-same-origin"><span class="secno">3.1.1</span> <span class="content">Separate applications, same origin</span></a>
        <li><a href="#separation-in-single-application"><span class="secno">3.1.2</span> <span class="content">Separation within a single application</span></a>
       </ul>
      <li>
       <a href="#threat-model"><span class="secno">3.2</span> <span class="content">Threat Model</span></a>
       <ul class="toc">
        <li><a href="#threat-model-cross-doc"><span class="secno">3.2.1</span> <span class="content">Cross-Document Attacker</span></a>
        <li><a href="#threat-model-out-of-scope"><span class="secno">3.2.2</span> <span class="content">Out of Scope Attacker</span></a>
       </ul>
      <li><a href="#suborigins-vs-origins"><span class="secno">3.3</span> <span class="content">Relationship of Suborigins to Origins</span></a>
      <li><a href="#representation"><span class="secno">3.4</span> <span class="content">Representation of Suborigins</span></a>
      <li><a href="#opting-in"><span class="secno">3.5</span> <span class="content">Opting into a Suborigin</span></a>
      <li><a href="#the-suborigin-header"><span class="secno">3.6</span> <span class="content">The <code>suborigin</code> header</span></a>
      <li><a href="#suborigin-in-js"><span class="secno">3.7</span> <span class="content">Accessing the Suborigin in JavaScript</span></a>
     </ul>
    <li>
     <a href="#access-control"><span class="secno">4</span> <span class="content">Access Control</span></a>
     <ul class="toc">
      <li><a href="#cors-ac"><span class="secno">4.1</span> <span class="content">CORS</span></a>
      <li><a href="#postmessage-ac"><span class="secno">4.2</span> <span class="content"><code>postMessage</code></span></a>
      <li><a href="#workers-ac"><span class="secno">4.3</span> <span class="content">Workers</span></a>
     </ul>
    <li>
     <a href="#impact"><span class="secno">5</span> <span class="content">Impact on Web Platform</span></a>
     <ul class="toc">
      <li><a href="#sensitive-permissions"><span class="secno">5.1</span> <span class="content">Relationship with Sensitive Permissions</span></a>
     </ul>
    <li>
     <a href="#framework"><span class="secno">6</span> <span class="content">Framework</span></a>
     <ul class="toc">
      <li><a href="#suborigin-of-resource"><span class="secno">6.1</span> <span class="content">Suborigin of a Resource</span></a>
      <li><a href="#comparing-suborigins"><span class="secno">6.2</span> <span class="content">Comparing Suborigins</span></a>
      <li>
       <a href="#serializing"><span class="secno">6.3</span> <span class="content">Serializing Suborigins</span></a>
       <ul class="toc">
        <li><a href="#unicode-serialization"><span class="secno">6.3.1</span> <span class="content">Unicode Serialization of a Suborigin</span></a>
        <li><a href="#ascii-serialization"><span class="secno">6.3.2</span> <span class="content">ASCII Serialization of a Suborigin</span></a>
       </ul>
      <li><a href="#security-model-opt-outs"><span class="secno">6.4</span> <span class="content">Security Model Opt-Outs</span></a>
     </ul>
    <li><a href="#practical-considerations"><span class="secno">7</span> <span class="content">Practical Considerations in Using Suborigins</span></a>
    <li>
     <a href="#security-considerations"><span class="secno">8</span> <span class="content">Security Considerations</span></a>
     <ul class="toc">
      <li><a href="#presentation-to-users"><span class="secno">8.1</span> <span class="content">Presentation of Suborigins to Users</span></a>
      <li><a href="#not-overthrowing-sop"><span class="secno">8.2</span> <span class="content">Not Overthrowing Same-Origin Policy</span></a>
     </ul>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ul>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul>
  </div>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>Currently, web applications are almost always compartmentalized by using
separate host names to establish separate web origins. This is useful for
helping to prevent XSS and other cross-origin attacks, but has many unintended
consequences. For example, it causes latency due to additional DNS lookups,
removes the ability to use single-origin features (such as the
history.pushState API), and creates cryptic host name changes in the user
experience. Perhaps most importantly, it results in an extremely inflexible
architecture that, once rolled out, cannot be easily and transparently changed
later on.</p>
   <p>There are several mechanisms for reducing the attack surface for XSS without
creating separate host-name based origins, but each pose their own problems.
Per-page Suborigins is an attempt to fill some of those gaps. Two of the most
notable mechanisms are Sandboxed IFrames <a data-link-type="biblio" href="#biblio-iframesandbox">[IFrameSandbox]</a> and Content Security
Policy (CSP) <a data-link-type="biblio" href="#biblio-csp2">[CSP2]</a>. Both are powerful but have shortcomings and there are
many external developers building legacy applications that find they cannot use
those tools.</p>
   <p>Application developers can use sandboxed frames to completely isolate untrusted content, but they
pose a large problem for containing trusted but potentially buggy code because
it is very difficult, by design, for them to communicate with other frames. The
synthetic origins assigned in a sandboxed frame are random and unpredictable,
making the use of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageport-postmessage">postMessage</a> and <a data-link-type="dfn" href="#cors">CORS</a> difficult. Moreover,
because they are by definition unique origins, with no relationship to the
original origin, designing permissions for them to access resources of the
original origin would be difficult.</p>
   <p class="issue" id="issue-081d98d7"><a class="self-link" href="#issue-081d98d7"></a> TODO: Problems with CSP sandbox goes well beyond this. synthetic origins
via CSP sandbox do not let you persist state. This makes it impossible to port
an old webpage to run unprivileged. Further, since sandbox inherits on all
iframes within so you can’t insert an iframe to say a widget since that gets
sandboxed too and so would need to be rewritten to support such a scenario.
This significantly complicates adoption. This probably needs to go into a new
section This significantly complicates adoption. This probably needs to go into
a new section.</p>
   <p>Content Security Policy is also promising but is generally incompatible with
current website design. Many notable companies found it impractical to retrofit
most of their applications with it. On top of this, until all applications
hosted within a single origin are simultaneously put behind CSP, the mechanism
offers limited incremental benefits, which is especially problematic for
companies with large portfolios of disparate products all under the same domain.</p>
   <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
   <ul>
    <li data-md="">
     <p>Provide a way for different applications hosted at the same physical origin to
separate their content into separate logical origins. For example, <code>https://foobar.com/application</code> and <code>https://foobar.com/widget</code>, today, are,
by definition, in the same origin, even if they are different applications.
Thus an XSS at <code>https://foobar.com/application</code> means an XSS at <code>https://foobar.com/widget</code>, even if <code>https://foobar.com/widget</code> is
"protected" by a strong Content Security Policy.</p>
    <li data-md="">
     <p>Similarly, provide a way for content authors to split their applications
into logical modules with origin level separation without using different real
origins. Content authors should not have to choose between putting all of
their content in the same origin, on different physical origins, or putting
content in anonymous unique origins (sandboxes).</p>
    <li data-md="">
     <p>Provide safe defaults but also make it as simple as possible to retrofit
legacy applications on the same physical origin with minimal programmatic changes.
This includes providing security-model opt-outs where necessary.</p>
   </ul>
   <h3 class="heading settled" data-level="1.2" id="usecases"><span class="secno">1.2. </span><span class="content">Use Cases/Examples</span><a class="self-link" href="#usecases"></a></h3>
   <p>We see effectively three different use cases for Per-page Suborigins:</p>
   <ol>
    <li data-md="">
     <p>Separating distinct applications served from the same domain due to
 deployment issues but do not need to extensively interact with other
 content. Examples include marketing campaigns, simple search UIs, and so on.</p>
    <li data-md="">
     <p>Enable secure isolation at modular boundaries within a larger web
 application by splitting the functional components into different
 suborigins. For example, a blogging application might isolate the main blog
 viewership module, the admin module, and the authoring module via separate
 suborigins.</p>
    <li data-md="">
     <p>Similar to (2), applications with many users can split information relating
 to different users into their own suborigin. For example, a social network
 might put each user profile into a unique suborigin so that an XSS within
 one profile cannot be used to immediately infect other users or read their
 personal messages stored within the account.</p>
   </ol>
   <div class="example" id="example-a934c896">
    <a class="self-link" href="#example-a934c896"></a> <code>https://example.com/</code> runs two applications, Chat and Shopping, used,
  respectively, for instant messaging and Internet shopping.  The site adminstrator runs 
  the former at <code>https://example.com/chat/</code>, and the latter at <code>https://example.com/shopping/</code>. 
    <p>The Shopping application has been very well tested and generally does not
  contain much untrusted content. In fact, it only takes simple text from
  advertisers, and that text only ever appears in HTML contexts, so the
  application is able to entity encode the text and stop nearly all cross-site
  scripting attacks on the application. Further, the developers have also
  enabled a strong Content Security Policy to mitigate potential XSS concerns
  on all pages under <code>https://example.com/shopping/</code>. The CSP policy only allows scripts
  from <code>scripts.example.com</code>.</p>
    <p>Historically, <code>https://example.com/chat/</code> has been riddled with cross-site
  scripting attacks. The application takes untrusted content from a wider
  variety of sources and for added complexity, that content ends up in many more
  contexts, such as HTML tag attributes. On top of that, the developers never
  bothered creating a CSP for the application.</p>
    <p>This is bad enough, but, unfortunately, it has led to the extremely bad
  consequence of attackers using the low hanging fruit of Chat to attack
  Shopping, the more desirable target. Cross-site scripting Shopping allows an
  attacker to buy goods with the user’s account, so this is really the juicy
  target.</p>
    <p>Since the applications share the same physical origin, these attacks have not
  traditionally been that difficult. Once an attacker has executed code on Chat
  with an XSS, they open a new window or iframe at <code>example.com/shopping/</code>.
  Since this is at the same origin as Chat, this allows the attacker to inject
  code through the <code>document</code> object of the window or iframe into the Shopping
  context, allowing the attacker to buy whatever they’d like.</p>
    <p>Historical and branding reasons require hosting both applications on the <code>example.com</code> origin. Thus, while these two applications are completely separate, the
  company cannot split the products into two different origins (e.g. <code>examplechat.com</code> and <code>exampleshopping.com</code>) or different suborigins (e.g. <code>chat.example.com</code> and <code>shopping.example.com</code>).</p>
    <p>To address this, the developers decide to serve both applications on two
  separate suborigins. For all HTTP requests to any subpath of <code>/chat</code> or <code>/shopping</code>, example.com includes a header <code>suborigin: chat</code> or <code>suborigin: shopping</code>, respectively.</p>
    <p>This does not remove any of the XSS attacks on Chat. However, when an attacker
  injects code into Chat and opens a window or iframe to <code>example.com/shopping/</code>, they can no longer inject content through the
  document as it will fail the same origin check. Of course, the application can
  still use <code>XMLHttpRequest</code> and <code>postMessage</code> to communicate with the document,
  but that will only be through well defined APIs.  In short, the CSP of the
  Shopping application is now actually effective as the permissive Chat
  application is no longer a bypass of it.</p>
   </div>
   <p class="issue" id="issue-9a0ddc8c"><a class="self-link" href="#issue-9a0ddc8c"></a> TODO: We probably should add additional examples, or perhaps match an
example to each bullet above.</p>
   <h2 class="heading settled" data-level="2" id="terms"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#terms"></a></h2>
   <p class="issue" id="issue-3c008d43"><a class="self-link" href="#issue-3c008d43"></a> TODO(jww) This needs to be filled in once we have a pretty good handle on
the basic structure of this document. At that point, we should extract the terms
defined throughout the spec and place them here.</p>
   <p>This section defines several terms used throughout the document.</p>
   <p>The terms <dfn data-dfn-type="dfn" data-noexport="" id="origin">origin<a class="self-link" href="#origin"></a></dfn>, <dfn data-dfn-type="dfn" data-noexport="" id="cross-origin">cross-origin<a class="self-link" href="#cross-origin"></a></dfn>, and <dfn data-dfn-type="dfn" data-noexport="" id="same-origin">same-origin<a class="self-link" href="#same-origin"></a></dfn> are defined by the Origin specification. <a data-link-type="biblio" href="#biblio-origin">[ORIGIN]</a></p>
   <p><dfn data-dfn-type="dfn" data-noexport="" id="cors">CORS<a class="self-link" href="#cors"></a></dfn>, or <dfn data-dfn-type="dfn" data-noexport="" id="cross-origin-resource-sharing">Cross-Origin Resource Sharing<a class="self-link" href="#cross-origin-resource-sharing"></a></dfn>, are defined by the
CORS specification. <a data-link-type="biblio" href="#biblio-cors">[CORS]</a></p>
   <p><dfn data-dfn-type="dfn" data-noexport="" id="xmlhttprequest">XMLHttpRequest<a class="self-link" href="#xmlhttprequest"></a></dfn>, or <dfn data-dfn-type="dfn" data-noexport="" id="xhr">XHR<a class="self-link" href="#xhr"></a></dfn>, is defined by the XMLHttpRequest
specification. <a data-link-type="biblio" href="#biblio-xhr">[XHR]</a></p>
   <p>The term <dfn data-dfn-type="dfn" data-noexport="" id="cross-site-scripting">cross-site scripting<a class="self-link" href="#cross-site-scripting"></a></dfn>, or <dfn data-dfn-type="dfn" data-noexport="" id="xss">XSS<a class="self-link" href="#xss"></a></dfn> for short, refers to
a content injection attack where an attacker is able to execute malicious code
in a victim origin. See the <a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">OWASP page on
Cross-site Scripting</a> for more information.</p>
   <h3 class="heading settled" data-level="2.1" id="grammar"><span class="secno">2.1. </span><span class="content">Grammatical Concepts</span><a class="self-link" href="#grammar"></a></h3>
    The Augmented Backus-Naur Form (ABNF) notation used in this document is
specified in RFC5234. <a data-link-type="biblio" href="#biblio-abnf">[ABNF]</a> 
   <p>Lowercase characters, the <code>a-z</code> portion of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a>, are defined by the grammar:</p>
<pre><dfn data-dfn-type="grammar" data-export="" id="grammardef-loweralpha">LOWERALPHA<a class="self-link" href="#grammardef-loweralpha"></a></dfn> = %x61-7A   ; a-z
</pre>
   <h2 class="heading settled" data-level="3" id="defining-suborigin"><span class="secno">3. </span><span class="content">Defining a Suborigin</span><a class="self-link" href="#defining-suborigin"></a></h2>
   <p>Origins are a mechanism for user agents to group URIs into protection domains.
As defined in <a data-link-type="biblio" href="#biblio-origin">[ORIGIN]</a>, two URIs are in the <a data-link-type="dfn" href="#same-origin">same-origin</a> if they share
the same <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-url-scheme">scheme</a>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-host">host</a>, and <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-url-port">port</a>.  If URIs are same-origin,
then they share the same authority and can access all of each others resources.</p>
   <p>Compared to per-user isolation in traditional operating systems, the
same-origin policy isolates distinct applications identified by their origins.
This has been a successful isolation mechanism on the Web.  However, it does
limit the flexibility of a page to separate itself into a new protection domain
as it automatically shares authority with all other identical origins. These origins
are defined by physical, rather than programmatic, properties.  While it is
possible to setup unique domains and ports for different parts of the same
application (scheme is more difficult to separate out), there are a diverse set
of practical problems in doing so.</p>
   <p>Suborigins provide a mechanism for creating this type of separation
programatically. Any resources may provide, in a manner detailed below, a string
value <a data-link-type="dfn" href="#suborigin-namespace">suborigin namespace</a>.  If either of two URIs provide a suborigin
namespace, then the two URIs are in the <a data-link-type="dfn" href="#same-origin">same-origin</a> if and only if they
share the same <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-url-scheme">scheme</a>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-host">host</a>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-url-port">port</a>, and <a data-link-type="dfn" href="#suborigin-namespace">suborigin
namespace</a>.</p>
   <p>Q. In today’s Web, can’t a site get the effective same protection domain simply
by hosting their content at different subdomains?</p>
   <p>A. Yes, but there are many practical reasons why this is difficult:</p>
   <h3 class="heading settled" data-level="3.1" id="difficulties"><span class="secno">3.1. </span><span class="content">Difficulties using subdomains</span><a class="self-link" href="#difficulties"></a></h3>
   <h4 class="heading settled" data-level="3.1.1" id="separate-applications-same-origin"><span class="secno">3.1.1. </span><span class="content">Separate applications, same origin</span><a class="self-link" href="#separate-applications-same-origin"></a></h4>
    Google runs Search and Maps on the same domain, respectively <code>https://www.google.com</code> and <code>https://www.google.com/maps</code>. While these two applications are
fundamentally separate, there are many reasons for hosting them on the same
origin, including historical links, branding, and performance.  However, from
security perspective, this means that a compromise of one application is a
compromise of the other since the only security boundary in the browser is the
origin, and both applications run in the same origin.  Thus, even if
Google Search were to successful implement a strong Content Security Policy <a data-link-type="biblio" href="#biblio-csp2">[CSP2]</a>, if Google Maps were to have an XSS vulnerability, it would be
equivalent to having an XSS on Google Search as well, negating Google Search’s
security measures. 
   <h4 class="heading settled" data-level="3.1.2" id="separation-in-single-application"><span class="secno">3.1.2. </span><span class="content">Separation within a single application</span><a class="self-link" href="#separation-in-single-application"></a></h4>
    Separation is sometimes desirable within a single application because of the
presence of untrusted data. Take, for example, a social networking site with
many different user profiles. Each profile contains lots of untrusted content
created by a single user but it’s all hosted on a single origin. In order to
separate untrusted content, the application might want a way to put all profile
information into separate logical origins while all being hosted at the same
physical origin. Furthermore, all content within a profile should be able to
access all other content within the same origin, even if displayed in unique
frames. 
   <p>This type of privilege separation within an application has been shown to be
valuable and reasonable for applications to do by work such as
Privilege Separation in HTML5 Applications by Akhawe et al <a data-link-type="biblio" href="#biblio-privilegeseparation">[PRIVILEGESEPARATION]</a>. However, these systems rely on cross frame messaging
using <code>postMessage</code> even for content in the same trust boundary since
they utilize <code>sandbox</code>. This provides much of the motivation for the
named container nature of suborigins.</p>
   <h3 class="heading settled" data-level="3.2" id="threat-model"><span class="secno">3.2. </span><span class="content">Threat Model</span><a class="self-link" href="#threat-model"></a></h3>
   <p><a data-link-type="dfn" href="#origin">Origins</a> and the <a href="http://www.w3.org/Security/wiki/Same_Origin_Policy">Same-Origin Policy</a> have provided a strong defense against
malicious applications. Instead of giving the application the power of the user,
applications on the Web are limited to a unique space that is defined by their
host. However, by tying the origin to the physical host, this has limited the
power of developers.</p>
   <p>Suborigins attempt to provide developers with tool to contain two different
principles that are on the same host. Suborigins allow two or more applications
or modules to be hosted at the same origin but use the same origin policy to
separate them from each other.</p>
   <h4 class="heading settled" data-level="3.2.1" id="threat-model-cross-doc"><span class="secno">3.2.1. </span><span class="content">Cross-Document Attacker</span><a class="self-link" href="#threat-model-cross-doc"></a></h4>
   <p>An attacker that is able to compromise one document should not be able to
control another document that is on the same host but delivered in a different
suborigin namespace. If an attacker is able to <a data-link-type="dfn" href="#xss">XSS</a>, for example, a
document on <code>example.com</code> delivered in the suborigin namespace <code>foo</code>,
the attacker should not be able to control any document on <code>example.com</code> not in the <code>foo</code> namespace.</p>
   <p class="issue" id="issue-ace20ff1"><a class="self-link" href="#issue-ace20ff1"></a> TODO(devd): Should we also assert that attacker on main/parent origin
cannot compromise the app in sub-origin?</p>
   <h4 class="heading settled" data-level="3.2.2" id="threat-model-out-of-scope"><span class="secno">3.2.2. </span><span class="content">Out of Scope Attacker</span><a class="self-link" href="#threat-model-out-of-scope"></a></h4>
   <p>This tool is purely for modularity and meant to be an application security tool.
It is <em>not</em> meant to help users differentiate between two different
applications at the same host, as reflected by the fact that user agents may not
put the suborigin in user-visible UI. Additionally, suborigins cannot protect
against colluding malicious or compromised applications.</p>
   <h3 class="heading settled" data-level="3.3" id="suborigins-vs-origins"><span class="secno">3.3. </span><span class="content">Relationship of Suborigins to Origins</span><a class="self-link" href="#suborigins-vs-origins"></a></h3>
   <p>Suborigins, in fact, do not provide any new authority to resources. Suborigins
simply provide <em>an additional way to construct Origins</em>. That is,
Suborigins do not supercede Origins or provide any additional authority above
Origins. From the user agent’s  perspective, two resources in different
Suborigins are simply in different Origins, and the relationship between the two
resources should be the same as any other two differing origins as described in <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>. However, given the impracticalities this may impart on some
applications who might want to adopt Suborigins, a few security-model opt-outs
to ease the use of Suborigins in legacy applications are also presented. See <a href="#security-model-opt-outs">§6.4 Security Model Opt-Outs</a> for more information.</p>
   <h3 class="heading settled" data-level="3.4" id="representation"><span class="secno">3.4. </span><span class="content">Representation of Suborigins</span><a class="self-link" href="#representation"></a></h3>
   <p>At an abstract level, a suborigin consists of the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-url-scheme">scheme</a>, <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-host">host</a>,
and <a data-link-type="dfn" href="https://url.spec.whatwg.org/#syntax-url-port">port</a> of a physical origin, plus a <a data-link-type="dfn" href="#suborigin-namespace">suborigin namespace</a>.
However, as mentioned above, suborigins are intended to fit within the framework
of <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>.  Therefore, this specification provides a way of serializing a
Suborigin bound resource into a physical origin. This is done by inserting
the suborigin namespace into the host of the Origin, thus creating a new host
but maintaining all of the information about both the original scheme, host,
port, and the suborigin namespace. The serialization format prepends the host name with
the suborigin namespace followed by a "<code>_</code>" character.</p>
   <p>For example, a resource hosted at <code>https://example.com/</code> in
the suborigin namespace <code>profile</code> would be serialized as <code>https://profile_example.com/</code>.</p>
   <p>Similarly, a resource hosted at <code>https://example.com:8080/</code> in
the suborigin namespace <code>separate</code> would be serialized as <code>https://separate_example.com:8080/</code>.</p>
   <p>Internally, the user agent just tracks the <a data-link-type="dfn" href="#suborigin-namespace">suborigin namespace</a> of the resource.
When the origin needs to be serialized, the user agent should
follow the algorithm in <a href="#serializing">§6.3 Serializing Suborigins</a>.</p>
   <p class="note" role="note">Note: The underscore character is not a valid character for hostnames used
on the web <a data-link-type="biblio" href="#biblio-rfc1123">[RFC1123]</a> and as a result, the serialization above cannot collide
with valid existing hostnames.</p>
   <h3 class="heading settled" data-level="3.5" id="opting-in"><span class="secno">3.5. </span><span class="content">Opting into a Suborigin</span><a class="self-link" href="#opting-in"></a></h3>
   <p>Unlike the <code>sandbox</code> attribute, suborigin namespaces are predictable and
controllable. Because of this, potentially untrusted content cannot opt into
suborigins, unlike iframe sandboxes. If they could, then an XSS on a site could
enter a specific suborigin and access all of its resources, thus violating the
isolation suborigins intend to provide. To prevent this, the
server (rather than a resource itself) is the only authoritative
source of the suborigin namespace of a resource. The server communicates the
suborigin of a resource to the user agent through a new <code>suborigin</code> header,
which takes a string value that is the namespace. For example, to put a
resource in the <code>testing</code> suborigin namespace, the server would specify the
following HTTP header in the response:</p>
<pre>suborigin: testing
</pre>
   <h3 class="heading settled" data-level="3.6" id="the-suborigin-header"><span class="secno">3.6. </span><span class="content">The <code>suborigin</code> header</span><a class="self-link" href="#the-suborigin-header"></a></h3>
   <p>Suborigins are defined by a <dfn data-dfn-type="dfn" data-noexport="" id="suborigin">suborigin<a class="self-link" href="#suborigin"></a></dfn> HTTP response header. The syntax
for the name and value of the header are described by the following ABNF
grammar <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>
<pre>suborigin = 1*( <a data-link-type="grammar" href="#grammardef-loweralpha">LOWERALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "-" )
</pre>
   <p>A resource’s <dfn data-dfn-type="dfn" data-noexport="" id="suborigin-namespace">suborigin namespace<a class="self-link" href="#suborigin-namespace"></a></dfn> is the value of the <code>suborigin</code> header. User agents MUST ignore multiple suborigin headers and only apply
the first.</p>
   <h3 class="heading settled" data-level="3.7" id="suborigin-in-js"><span class="secno">3.7. </span><span class="content">Accessing the Suborigin in JavaScript</span><a class="self-link" href="#suborigin-in-js"></a></h3>
   <p>A <code>suborigin</code> property is added to the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">document</a> object which <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-reflect">reflects</a> the value of the suborigin namespace for the current execution
context. In there is no suborigin namespace, the value should be undefined.</p>
   <p>Additionally, the <code>origin</code> property of the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document">document</a> object should reflect
the serialized value of the origin as returned by <a href="#serializing">§6.3 Serializing Suborigins</a>.</p>
   <h2 class="heading settled" data-level="4" id="access-control"><span class="secno">4. </span><span class="content">Access Control</span><a class="self-link" href="#access-control"></a></h2>
   <p>Cross-origin (including cross-suborigin) communication is tricky when suborigins
are involved because they need to be backwards compatible with user agents that
do not support suborigins while providing origin-separation for user agents that
do support suborigins. The following discussions discuss the three major
cross-origin mechanisms that are relevant: <a data-link-type="dfn" href="#cors">CORS</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageport-postmessage"><code>postMessage</code></a>,
and Workers <a data-link-type="biblio" href="#biblio-workers">[WORKERS]</a>.</p>
   <p class="issue" id="issue-d5c3193c"><a class="self-link" href="#issue-d5c3193c"></a> TODO(devd): Making things specific to XHR or CORS is weird. We should
just make all fetches inside a suborigin CORS fetches and be done with it.</p>
   <h3 class="heading settled" data-level="4.1" id="cors-ac"><span class="secno">4.1. </span><span class="content">CORS</span><a class="self-link" href="#cors-ac"></a></h3>
   <p>For pages in a suborigin namespace, all <a data-link-type="dfn" href="#xmlhttprequest"><code>XMLHttpRequest</code></a>s and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org#concept-fetch"><code>fetch</code></a> requests to any URL should be treated as cross-origin, thus
triggering a <a data-link-type="dfn" href="https://www.w3.org/TR/cors#cross-origin-request-with-preflight-0">cross-origin request with preflight</a> for all non-<a data-link-type="dfn" href="https://www.w3.org/TR/cors#simple-cross-origin-request">simple
cross-origin requests</a>. Additionally, all requests from a suborigin namespace
must include a <code>Suborigin</code> header whose value is the context’s suborigin name.
Finally, the <code>Origin</code> header <a data-link-type="biblio" href="#biblio-origin">[ORIGIN]</a> value must use the serialized suborigin
value instead of the serializied origin, as described in <a href="#serializing">§6.3 Serializing Suborigins</a>.</p>
   <p>Similar changes are needed for responses from the server with the addition of an <code>Access-Control-Allow-Suborigin</code> response header. Its value must match the
context’s suborigin namespace value, or <code>*</code> to allow all suborigin namespaces.
At the same time, the <code>Access-Control-Allow-Origin</code> response header value must
be modified to use the serialized suborigin value instead of the serializied
origin, as described in <a href="#serializing">§6.3 Serializing Suborigins</a>.</p>
   <p class="issue" id="issue-282a2442"><a class="self-link" href="#issue-282a2442"></a> TODO(jww): Formal definition of the headers and responses w/grammars.
Also need to be explicit about <code>*</code> having same limitations as <code>Access-Control-Allow-Origin</code> w/credentials.</p>
   <h3 class="heading settled" data-level="4.2" id="postmessage-ac"><span class="secno">4.2. </span><span class="content"><code>postMessage</code></span><a class="self-link" href="#postmessage-ac"></a></h3>
   <p>Cross-origin messaging via <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageport-postmessage"><code>postMessage</code></a> requires that the
recipient be able to see the suborigin namespace of the message sender so it can make an
appropriate access control decision. When a message is sent from a
suborigin namespace, the receiver has the <code>event.origin</code> value set to the
serialized suborigin value instead of the serializied origin, as described in <a href="#serializing">§6.3 Serializing Suborigins</a>. Additionally, a new <code>suborigin</code> property must be added to the <code>MessageEvent</code> given to the receiver which contains the suborigin namespace
value.</p>
   <h3 class="heading settled" data-level="4.3" id="workers-ac"><span class="secno">4.3. </span><span class="content">Workers</span><a class="self-link" href="#workers-ac"></a></h3>
   <p>User agents MUST refuse to create or execute any workers in a page executing in
a sub-origin.</p>
   <p class="note" role="note">Note: This may change in the future, and Suborigins may eventually be allowed to
register Service Workers, but, for now, allowing the creation of any workers,
including service workers and shared workers, from suborigins adds too many
complications. Applications can still create workers by iframing a page not in
a suborigin.</p>
   <h2 class="heading settled" data-level="5" id="impact"><span class="secno">5. </span><span class="content">Impact on Web Platform</span><a class="self-link" href="#impact"></a></h2>
   <p>Content inside a suborigin namespace is restricted in the same way that other
origins are restricted. There are some additional restrictions as well, in order
to simplfy some complicated cases, and there are also some loosening of
same-origin restrctions in order to facilitate and ease adoption of suborigins
for developers.</p>
   <h3 class="heading settled" data-level="5.1" id="sensitive-permissions"><span class="secno">5.1. </span><span class="content">Relationship with Sensitive Permissions</span><a class="self-link" href="#sensitive-permissions"></a></h3>
   <p>User agents MUST prevent a page running in a suborigin from accessing stateful
mechanisms (e.g., localStorage, sessionStorage, document.cookie) tied to the
parent, physical origin. Instead, the user agent SHOULD create a new object
tied to the namespaced suborigin.</p>
   <p>User agents MUST ignore modifications to the document.domain property of the page.</p>
   <h2 class="heading settled" data-level="6" id="framework"><span class="secno">6. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
   <p class="note" role="note">Note: These sections are tricky because, unlike physical origins, we can’t
define suborigins in terms of URIs. Since the suborigin namespace is defined in
a header, not in the URI, we need to define them in terms of resources.</p>
   <h3 class="heading settled" data-level="6.1" id="suborigin-of-resource"><span class="secno">6.1. </span><span class="content">Suborigin of a Resource</span><a class="self-link" href="#suborigin-of-resource"></a></h3>
   <p>The suborigin of a resource is the value computed by the following algorithm:</p>
   <ol>
    <li> Let origin be the triple result from starting with step 1 of Section 4 of
    the <a href="https://tools.ietf.org/html/rfc6454#section-4">Section 4</a> of
    of the Origin specification. <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a> 
    <li> If the HTTP response of the resource contains a valid
    [suborigin] header, then let <code>suborigin-namespace</code> be the
    value of the header. 
    <li> Otherwise, let <code>suborigin-namespace</code> be <code>null</code>. 
    <li> Return the pair <code>(origin, suborigin-namespace)</code>. 
   </ol>
   <h3 class="heading settled" data-level="6.2" id="comparing-suborigins"><span class="secno">6.2. </span><span class="content">Comparing Suborigins</span><a class="self-link" href="#comparing-suborigins"></a></h3>
   <p>Two suborigins are "the same" if, and only if, they are identical. In
particular:</p>
   <ul>
    <li data-md="">
     <p>If the origin portions of the suborigin pairs are scheme/host/port triples,
  the two suborigins are the same if, and only if, they have identical
  schemes, hosts, and ports and the <code>suborigin-namespace</code> portions
  of the suborigin pairs are identical.</p>
    <li data-md="">
     <p>If both <code>suborigin-namespace</code> portions of the suborigin pairs are
  null, this is considered identical.</p>
    <li data-md="">
     <p>An origin that is a globally unique identifier cannot be the same as an
  origin that is a scheme/host/port triple, with or without a <code>suborigin-namespace</code>.</p>
   </ul>
   <p>Two resources are the same-origin if their suborigins are the same.</p>
   <h3 class="heading settled" data-level="6.3" id="serializing"><span class="secno">6.3. </span><span class="content">Serializing Suborigins</span><a class="self-link" href="#serializing"></a></h3>
   <p>This section defines how to serialize an origin to a unicode <a data-link-type="biblio" href="#biblio-unicode6">[Unicode6]</a> string and to an ASCII <a data-link-type="biblio" href="#biblio-rfc0020">[RFC0020]</a> string.</p>
   <h4 class="heading settled" data-level="6.3.1" id="unicode-serialization"><span class="secno">6.3.1. </span><span class="content">Unicode Serialization of a Suborigin</span><a class="self-link" href="#unicode-serialization"></a></h4>
   <p>The Unicode serialization of a suborigin is the value returned by the following
algorithm:</p>
   <ol>
    <li data-md="">
     <p>If the origin portion of the suborigin pair is not a scheme/host/port
 triple, then return the string</p>
<pre>null
</pre>
     <p>(i.e., the code point sequence U+006E, U+0075, U+006C, U+006C) and abort
  these steps.</p>
    <li data-md="">
     <p>Otherwise, if the suborigin namespace portion of the suborigin pair is not
 null:</p>
     <ol>
      <li data-md="">
       <p>Let <var>prefix</var> be the suborigin namespace portion of the suborigin pair.</p>
      <li data-md="">
       <p>Append the string "_" to <var>prefix</var>.</p>
      <li data-md="">
       <p>Prepend <var>prefix</var> to the host part of the origin triple.</p>
     </ol>
    <li data-md="">
     <p>Proceed with step 1 of <a href="https://tools.ietf.org/html/rfc6454#section-6.1">Section 6.1 in the
 Origin specification</a> <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>.</p>
   </ol>
   <h4 class="heading settled" data-level="6.3.2" id="ascii-serialization"><span class="secno">6.3.2. </span><span class="content">ASCII Serialization of a Suborigin</span><a class="self-link" href="#ascii-serialization"></a></h4>
   <p>The ASCII serialization of a suborigin is the value returned by the following
algorithm:</p>
   <ol>
    <li data-md="">
     <p>If the origin portion of the suborigin pair is not a scheme/host/port
 triple, then return the string</p>
<pre>null
</pre>
     <p>(i.e., the code point sequence U+006E, U+0075, U+006C, U+006C) and abort
these steps.</p>
    <li data-md="">
     <p>Otherwise, if the suborigin-namespace portion of the suborigin pair is not
 null:</p>
     <ol>
      <li data-md="">
       <p>Let suffix be the string "+".</p>
      <li data-md="">
       <p>Append the suborigin-namespace portion of the suborigin pair to suffix.</p>
      <li data-md="">
       <p>Append suffix to the scheme part of the origin triple.</p>
     </ol>
    <li data-md="">
     <p>Proceed with step 1 of <a href="https://tools.ietf.org/html/rfc6454#section-6.2">Section 6.2 in the
 Origin specification</a> <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>.</p>
   </ol>
   <h3 class="heading settled" data-level="6.4" id="security-model-opt-outs"><span class="secno">6.4. </span><span class="content">Security Model Opt-Outs</span><a class="self-link" href="#security-model-opt-outs"></a></h3>
   <p class="issue" id="issue-e7f074e1"><a class="self-link" href="#issue-e7f074e1"></a> TODO: Fill in sub sections for the various security model opt-outs.
This includes document.cookie access, how event.origin is serialized in
postMessage, localStorage sharing, how to use old-school Origin header and ACAO
header.</p>
   <h2 class="heading settled" data-level="7" id="practical-considerations"><span class="secno">7. </span><span class="content">Practical Considerations in Using Suborigins</span><a class="self-link" href="#practical-considerations"></a></h2>
   <p>Using suborigins with a Web application should be relatively simple. At the most
basic level, if you have an application hosted on <code>https://example.com/app/</code>, and all of its resources are hosted at
subpaths of <code>/app</code>, it requires that the server set a Content
Security Policy on all HTTP requests to subpaths of <code>/app</code> that
contain the header <code>suborigin: namespace</code>, where <code>namespace</code> is of the application’s choosing. This will ensure that
the user agent loads all of these resources into the suborigin <code>namespace</code> and will enforce this boundary accordingly.</p>
   <p>Additionally, if your application allows cross-origin requests, instead of
adding the usual <code>Access-Control-Allow-Origin</code> header for
cross-origin requests, the server must add the <code>Access-Control-Allow-Finer-Origin</code> and <code>Access-Control-Allow-Suborigin</code> headers, as defined in <a href="#cors-ac">§4.1 CORS</a>.</p>
   <p>In the client-side portion of the application, if <code>postMessage</code> is
used, the application must be modified so it does not check the <code>event.origin</code> field.  Instead, it should check <code>event.finerorigin</code> and additionally the <code>event.suborigin</code> fields, as they are defined in <a href="#postmessage-ac">§4.2 postMessage</a>.</p>
   <h2 class="heading settled" data-level="8" id="security-considerations"><span class="secno">8. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
   <h3 class="heading settled" data-level="8.1" id="presentation-to-users"><span class="secno">8.1. </span><span class="content">Presentation of Suborigins to Users</span><a class="self-link" href="#presentation-to-users"></a></h3>
   <p>A complication of suborigins is that while they provide a meaningful security
for an application, that boundary makes much less sense to a user. That is,
physical origins provide a security boundary at a physical level: separate
scheme, hosts, and ports map to real boundaries external of a given application.
However, suborigins as a boundary only makes sense <em>within the context of the
program logic itself</em>, and there is no meaningful way for users to make
decisions based on suborigins a priori.</p>
   <p>Therefore, suborigins should be used only internally in a user agent and MUST
NOT be presented to users at all. For example, user agents must never present
suborigins in link text or a URL bar.</p>
   <h3 class="heading settled" data-level="8.2" id="not-overthrowing-sop"><span class="secno">8.2. </span><span class="content">Not Overthrowing Same-Origin Policy</span><a class="self-link" href="#not-overthrowing-sop"></a></h3>
   <p>Suborigins do not fundamentally change how the same-origin policy works. An
application without suborigins should work identically to how it always has, and
even in an application with suborigins, the same-origin policy still applies as
always. In fact, this document defines suborigins within the context of the
same-origin policy so that, in theory, serialized suborigins can be thought of
as a just a special case of the traditional same-origin policy.</p>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li><a href="#cors">CORS</a><span>, in §2</span>
   <li><a href="#cross-origin">cross-origin</a><span>, in §2</span>
   <li><a href="#cross-origin-resource-sharing">Cross-Origin Resource Sharing</a><span>, in §2</span>
   <li><a href="#cross-site-scripting">cross-site scripting</a><span>, in §2</span>
   <li><a href="#grammardef-loweralpha">LOWERALPHA</a><span>, in §2.1</span>
   <li><a href="#origin">origin</a><span>, in §2</span>
   <li><a href="#same-origin">same-origin</a><span>, in §2</span>
   <li><a href="#suborigin">suborigin</a><span>, in §3.6</span>
   <li><a href="#suborigin-namespace">suborigin namespace</a><span>, in §3.6</span>
   <li><a href="#xhr">XHR</a><span>, in §2</span>
   <li><a href="#xmlhttprequest">XMLHttpRequest</a><span>, in §2</span>
   <li><a href="#xss">XSS</a><span>, in §2</span>
  </ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li>
    <a data-link-type="biblio" href="#biblio-abnf">[ABNF]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">alpha</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">digit</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-cors">[cors]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/cors#cross-origin-request-with-preflight-0">cross-origin request with preflight</a>
     <li><a href="https://www.w3.org/TR/cors#simple-cross-origin-request">simple cross-origin request</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org#concept-fetch">fetch</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/comms.html#dom-messageport-postmessage">postmessage</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-url">[url]</a> defines the following terms:
    <ul>
     <li><a href="https://url.spec.whatwg.org/#syntax-host">host</a>
     <li><a href="https://url.spec.whatwg.org/#syntax-url-port">port</a>
     <li><a href="https://url.spec.whatwg.org/#syntax-url-scheme">scheme</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-dom-ls">[dom-ls]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#concept-document">document</a>
     <li><a href="https://dom.spec.whatwg.org/#concept-reflect">reflect</a>
    </ul>
  </ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-abnf"><a class="self-link" href="#biblio-abnf"></a>[ABNF]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-fetch"><a class="self-link" href="#biblio-fetch"></a>[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-origin"><a class="self-link" href="#biblio-origin"></a>[ORIGIN]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-unicode6"><a class="self-link" href="#biblio-unicode6"></a>[UNICODE6]
   <dd>The Unicode Consortium. <a href="http://www.unicode.org/versions/Unicode6.2.0/">The Unicode Standard, Version 6.2.0</a>. URL: <a href="http://www.unicode.org/versions/Unicode6.2.0/">http://www.unicode.org/versions/Unicode6.2.0/</a>
   <dt id="biblio-xhr"><a class="self-link" href="#biblio-xhr"></a>[XHR]
   <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/">XMLHttpRequest Standard</a>. Living Standard. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
   <dt id="biblio-cors"><a class="self-link" href="#biblio-cors"></a>[CORS]
   <dd>Anne van Kesteren. <a href="http://www.w3.org/TR/cors/">Cross-Origin Resource Sharing</a>. 16 January 2014. REC. URL: <a href="http://www.w3.org/TR/cors/">http://www.w3.org/TR/cors/</a>
   <dt id="biblio-dom-ls"><a class="self-link" href="#biblio-dom-ls"></a>[DOM-LS]
   <dd>Document Object Model URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-rfc0020"><a class="self-link" href="#biblio-rfc0020"></a>[RFC0020]
   <dd>V.G. Cerf. <a href="https://tools.ietf.org/html/rfc20">ASCII format for network interchange</a>. October 1969. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc20">https://tools.ietf.org/html/rfc20</a>
   <dt id="biblio-rfc1123"><a class="self-link" href="#biblio-rfc1123"></a>[RFC1123]
   <dd>R. Braden, Ed.. <a href="https://tools.ietf.org/html/rfc1123">Requirements for Internet Hosts - Application and Support</a>. October 1989. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc1123">https://tools.ietf.org/html/rfc1123</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc5234"><a class="self-link" href="#biblio-rfc5234"></a>[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-rfc6454"><a class="self-link" href="#biblio-rfc6454"></a>[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-url"><a class="self-link" href="#biblio-url"></a>[URL]
   <dd>Anne van Kesteren; Sam Ruby. <a href="http://www.w3.org/TR/url-1/">URL</a>. 9 December 2014. WD. URL: <a href="http://www.w3.org/TR/url-1/">http://www.w3.org/TR/url-1/</a>
   <dt id="biblio-workers"><a class="self-link" href="#biblio-workers"></a>[WORKERS]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/workers/">Web Workers</a>. 24 September 2015. WD. URL: <a href="http://www.w3.org/TR/workers/">http://www.w3.org/TR/workers/</a>
  </dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-csp2"><a class="self-link" href="#biblio-csp2"></a>[CSP2]
   <dd>Mike West; Adam Barth; Daniel Veditz. <a href="http://www.w3.org/TR/CSP2/">Content Security Policy Level 2</a>. 21 July 2015. CR. URL: <a href="http://www.w3.org/TR/CSP2/">http://www.w3.org/TR/CSP2/</a>
   <dt id="biblio-iframesandbox"><a class="self-link" href="#biblio-iframesandbox"></a>[IFrameSandbox]
   <dd>Mike West. <a href="http://www.html5rocks.com/en/tutorials/security/sandboxed-iframes/">Play safely in sandboxed IFrames</a>. URL: <a href="http://www.html5rocks.com/en/tutorials/security/sandboxed-iframes/">http://www.html5rocks.com/en/tutorials/security/sandboxed-iframes/</a>
   <dt id="biblio-privilegeseparation"><a class="self-link" href="#biblio-privilegeseparation"></a>[PRIVILEGESEPARATION]
   <dd>Devdatta Akhawe; Prateek Saxena; Dawn Song. <a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final168.pdf">Privilege Separation in HTML5 Applications</a>. URL: <a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final168.pdf">https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final168.pdf</a>
  </dl>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> TODO: Problems with CSP sandbox goes well beyond this. synthetic origins
via CSP sandbox do not let you persist state. This makes it impossible to port
an old webpage to run unprivileged. Further, since sandbox inherits on all
iframes within so you can’t insert an iframe to say a widget since that gets
sandboxed too and so would need to be rewritten to support such a scenario.
This significantly complicates adoption. This probably needs to go into a new
section This significantly complicates adoption. This probably needs to go into
a new section.<a href="#issue-081d98d7"> ↵ </a></div>
   <div class="issue"> TODO: We probably should add additional examples, or perhaps match an
example to each bullet above.<a href="#issue-9a0ddc8c"> ↵ </a></div>
   <div class="issue"> TODO(jww) This needs to be filled in once we have a pretty good handle on
the basic structure of this document. At that point, we should extract the terms
defined throughout the spec and place them here.<a href="#issue-3c008d43"> ↵ </a></div>
   <div class="issue"> TODO(devd): Should we also assert that attacker on main/parent origin
cannot compromise the app in sub-origin?<a href="#issue-ace20ff1"> ↵ </a></div>
   <div class="issue"> TODO(devd): Making things specific to XHR or CORS is weird. We should
just make all fetches inside a suborigin CORS fetches and be done with it.<a href="#issue-d5c3193c"> ↵ </a></div>
   <div class="issue"> TODO(jww): Formal definition of the headers and responses w/grammars.
Also need to be explicit about <code>*</code> having same limitations as <code>Access-Control-Allow-Origin</code> w/credentials.<a href="#issue-282a2442"> ↵ </a></div>
   <div class="issue"> TODO: Fill in sub sections for the various security model opt-outs.
This includes document.cookie access, how event.origin is serialized in
postMessage, localStorage sharing, how to use old-school Origin header and ACAO
header.<a href="#issue-e7f074e1"> ↵ </a></div>
  </div>
 </body>
</html>